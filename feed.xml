<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.3.3">Jekyll</generator><link href="https:/mirkomazzoleni.github.io/feed.xml" rel="self" type="application/atom+xml"/><link href="https:/mirkomazzoleni.github.io/" rel="alternate" type="text/html" hreflang="en"/><updated>2024-08-12T09:36:43+00:00</updated><id>https:/mirkomazzoleni.github.io/feed.xml</id><title type="html">blank</title><subtitle>Mirko Mazzoleni&apos;s academic web page. </subtitle><entry><title type="html">Visualizing Classification Results - Confusion Star and Confusion Gear</title><link href="https:/mirkomazzoleni.github.io/blog/2022/confusion_gears/" rel="alternate" type="text/html" title="Visualizing Classification Results - Confusion Star and Confusion Gear"/><published>2022-01-16T00:00:00+00:00</published><updated>2022-01-16T00:00:00+00:00</updated><id>https:/mirkomazzoleni.github.io/blog/2022/confusion_gears</id><content type="html" xml:base="https:/mirkomazzoleni.github.io/blog/2022/confusion_gears/"><![CDATA[<p><strong>Authors:</strong> Amalia <strong>Luque</strong>\(^1\), Mirko <strong>Mazzoleni</strong>\(^2\), Alejandro <strong>Carrasco</strong>\(^3\) and Antonio <strong>Ferramosca</strong>\(^2\)<br/> \(^1\) <em>Departamento de Ingeniería del Diseño, Escuela Politécnica Superior, Universidad de Sevilla, 41011 Seville, Spain</em> <br/> \(^2\) <em>Department of Management, Information and Production Engineering, University of Bergamo, 24044 Dalmine, Italy</em><br/> \(^3\) <em>Departamento de Tecnología Electrónica, School of Computer Engineering, Universidad de Sevilla, 41012 Seville, Spain</em></p> <p>In this post, we present two new visualization tools, called <strong>confusion star</strong> and <strong>confusion gear</strong>, for the <strong>representation of classification performance of multiclass classifiers</strong>. More details can be found in the paper [1]:</p> <ul> <li> <p><a href="https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&amp;arnumber=9658486">Open-access paper on IEEE Access</a></p> </li> <li> <p><a href="https://github.com/amalialuque/confusionstar">Python code Github repository</a></p> </li> </ul> <p>You can cite the paper as:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@ARTICLE{9658486,
author={Luque, Amalia and Mazzoleni, Mirko and Carrasco, Alejandro and Ferramosca, Antonio},
  journal={IEEE Access},
  title={Visualizing Classification Results: Confusion Star and Confusion Gear},
  year={2022},
  volume={10},
  number={},
  pages={1659-1677},
  doi={10.1109/ACCESS.2021.3137630}}
</code></pre></div></div> <h2 id="matrices-for-representing-classification-results">Matrices for representing classification results</h2> <p>We start our discussion by presenting three matrices:</p> <ul> <li> <p>the <strong>confusion matrix</strong>, used to represent the number of correctly and incorrectly classified instances;</p> </li> <li> <p>the <strong>hits matrix</strong><em>,</em> used to represent the number of correctly classified instances;</p> </li> <li> <p>the <strong>errors matrix</strong><em>,</em> used to represent the number of incorrectly classified instances.</p> </li> </ul> <h3 id="confusion-matrix">Confusion matrix</h3> <p>Classification results from machine learning algorithms are commonly summarized in the form of a <strong>confusion matrix</strong>, especially for representing a dichotomous (\(2\)-classes) classification tasks. As the name suggests, a confusion matrix is a table representing the <strong>number of correctly and incorrectly classified instances</strong>, see Table 1.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2022-01-16-confusion_gears/confusion_matrix-480.webp 480w,/assets/img/posts/2022-01-16-confusion_gears/confusion_matrix-800.webp 800w,/assets/img/posts/2022-01-16-confusion_gears/confusion_matrix-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/posts/2022-01-16-confusion_gears/confusion_matrix.jpg" class="img-fluid rounded z-depth-1" width="50%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p><em>Table 1: Binary confusion matrix for a \(2\)-classes classification task</em></p> <p>In the two-classes case, this matrix representation is visually effective: it is immediately clear if the classifier is performing well, as <strong>the number of false positives and false negatives should be as low as possible.</strong></p> <p>However, this representation suffers when <strong>more than two classes</strong> are present. A simple way to visualize the results of a \(C\)-classes classification problem (when \(C&gt;2\)) would be to employ a <strong>one-vs-all strategy:</strong></p> <ul> <li> <p>select a class to be the “Positive” one. All the other classes will constitute the “Negative” class;</p> </li> <li> <p>build a binary confusion matrix representing the Positive vs. Negative classes. Repeat this process until all classes played the role of the “Positive” one;</p> </li> <li> <p>visualize the \(C\) binary confusion matrices.</p> </li> </ul> <p>While easy to perform, this one-vs-all representation is far less effective.</p> <p>As an example, consider the famous MNIST (Modified National Institute of Standards and Technology) [2], that contains 70.000 images, each of them representing an handwritten digit (0 to 9). We trained a shallow MLP (Multi-Layer Perceptron) neural network on the first 60.000 images, and evaluated its results on the remaining 10.000 images. In the MNIST case, \(C=10\) figures have to be depicted and the overall algorithm performance is difficult to evaluate. Figure 1 shows the \(10\) confusion matrices, with cell elements expressed as percentages normalized by column (the actual class).</p> <p><img src="/images/2022-01-16-confusion_gears/onevsall_cm.png" alt="" title="Unit binary confusion matrices for MNIST test data"/> <em>Figure 1: Unit binary confusion matrices for MNIST test data.</em></p> <p>In order to understand the performance of the classifier upon \(10\) classes, we have to look at each confusion matrix singularly. An <strong>overall interpretation is possible but rather difficult.</strong></p> <p>Instead of visualizing multiple classification matrices, we propose two new visualizations for better assessing the classification performance of a multiclass classifier:</p> <ul> <li> <p><strong>Confusion star:</strong> focused on representing <strong>classification errors</strong> (the lower the better) for each class;</p> </li> <li> <p><strong>Confusion gears:</strong> focused on representing <strong>classification hits</strong> (the higher the better) for each class.</p> </li> </ul> <p>First, we need to introduce what <strong>errors matrix</strong> and <strong>hits matrix</strong> are.</p> <h3 id="errors-matrix">Errors matrix</h3> <p>Suppose to have at disposal the confusion matrix of a \(3\)-class classification task as</p> \[\mathbf{CM} \equiv \begin{bmatrix} m_{11} &amp; m_{12} &amp; m_{13} \\ m_{21} &amp; m_{22} &amp; m_{23} \\ m_{31} &amp; m_{23} &amp; m_{33} \\ \end{bmatrix}\] <p>where \(m_{ij}\) is the number of instances of the \(j\)-th class classified to the \(i\)-th class. Ideally, <em>for a perfect classification,</em> we want \(m_{ij}=0\) for \(i\neq j\).</p> <p>The <strong>total number of instances classified</strong> <em>to the</em> \(i\)<em>-th class</em> is the sum of the \(i\)-th row of the confusion matrix, that is</p> \[m_i = \sum_{j=1}^{C} m_{ij}\] <p>The <strong>errors matrix</strong> is defined by the \(i,j\) elements</p> \[e_{ij} \equiv \begin{cases} m_i - m_{ii} &amp; i=j \\ m_{ij} &amp; i\neq j \end{cases}\] <p>so that, in our example, we get</p> \[\mathbf{EM} \equiv \begin{bmatrix} e_{11} &amp; e_{12} &amp; e_{13} \\ e_{21} &amp; e_{22} &amp; e_{23} \\ e_{31} &amp; e_{32} &amp; e_{33} \\ \end{bmatrix} = \begin{bmatrix} m_{1}-m_{11} &amp; m_{12} &amp; m_{13} \\ m_{21} &amp; m_2-m_{22} &amp; m_{23} \\ m_{31} &amp; m_{32} &amp; m_3-m_{33} \\ \end{bmatrix}\] <p>Here, a <em>perfect classification</em> means \(e_{ij}=0\) for all \(i,j\), i.e. \(m_{ij}=0\) (no misclassifications), so that</p> \[\mathbf{EM} = \begin{bmatrix} 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 \\ \end{bmatrix}\] <p>The \(i\)-th row \(\mathbf{EM}_i\) of this matrix can also be formulated in terms of the ratio over the total number of instances belonging to the \(i\)-th class</p> \[\mathbf{EM}_i \equiv \begin{bmatrix} \epsilon_{i1}\cdot m_i &amp; \epsilon_{i2}\cdot m_i &amp; \epsilon_{i3}\cdot m_i \end{bmatrix}\] <p>where \(\epsilon_{ij}=e_{ij}/m_i\). The matrix \(\mathbf{E}=\{\psi_{ij}\}\) is called the <strong>unit errors matrix</strong><em>,</em> and it is a normalized version (entries with values 0-1) of the original hit matrix. The unit errors matrix allows to reason in 0-100% percentages or errors.</p> <h3 id="hits-matrix">Hits matrix</h3> <p>The <strong>hits matrix</strong> is defined by the \(i,j\) elements</p> \[w_{ij} \equiv \begin{cases} m_{ii} &amp; i=j \\ m_{i} - m_{ij} &amp; i\neq j \end{cases}\] <p>so that, in our example, we get</p> \[\mathbf{HM} \equiv \begin{bmatrix} w_{11} &amp; w_{12} &amp; w_{13} \\ w_{21} &amp; w_{22} &amp; w_{23} \\ w_{31} &amp; w_{32} &amp; w_{33} \\ \end{bmatrix} = \begin{bmatrix} m_{11} &amp; m_{1} - m_{12} &amp; m_{1} - m_{13} \\ m_{2} - m_{21} &amp; m_{22} &amp; m_{2} - m_{23} \\ m_{3} - m_{31} &amp; m_{3} - m_{32} &amp; m_{33} \\ \end{bmatrix}\] <p>Here, a <em>perfect classification</em> means \(w_{ij}=m_{i}\) for all \(j\), i.e. \(m_{ij}=0\) (no misclassifications), so that</p> \[\mathbf{HM} = \begin{bmatrix} m_{1} &amp; m_1 &amp; m_1 \\ m_2 &amp; m_2 &amp; m_2 \\ m_{3} &amp; m_{3} &amp; w_{3} \\ \end{bmatrix}\] <p>The \(i\)-th row \(\mathbf{HM}_i\) of this matrix can also be formulated in terms of the ratio over the total number of instances belonging to the \(i\)-th class</p> \[\mathbf{HM}_i \equiv \begin{bmatrix} \psi_{i1}\cdot m_i &amp; \psi_{i2}\cdot m_i &amp; \psi_{i3}\cdot m_i \end{bmatrix}\] <p>where \(\psi_{ij}=w_{ij}/m_i\). The matrix \(\boldsymbol{\Psi}=\{\psi_{ij}\}\) is called the <strong>unit hits matrix</strong><em>,</em> and it is a normalized version (entries with values 0-1) of the original hit matrix. The unit hits matrix allows to reason in 0-100% percentages of correct classifications.</p> <h2 id="confusion-star-plot">Confusion star plot</h2> <p>The confusion star plot depicts the <strong>non-diagonal elements of the errors matrix</strong> \(\mathbf{EM}\) or \(\mathbf{E}\) in a circle. So, we have a visual inspection of the <strong>classification errors from one class relative to all other ones</strong>. The circle is divided in \(C\) arcs (one for each class), and each arc is again divided in \(C-1\) sectors (all but the sector corresponding to the relative arc’s class).</p> <h4 id="confusion-star-for-final-classification-performance">Confusion star for final classification performance</h4> <p>Figure 2 shows the confusion star based on the unit errors matrix of the model trained on the MNIST dataset. We have \(C=10\) arcs, named from 0 to 9. Then, each arc has \(C-1=9\) sectors, each one numbered from 0 to 9 but without the corresponding class of that arc.</p> <p>Consider for instance <strong>class 0</strong> and <strong>class 2</strong>. Here, it is immediate to observe how class 0 instances are mostly confused with class 5 ones, and that class 2 struggles with class 1 and class 7. We remark that a <strong>perfect classification will results in an empty confusion star</strong><em>.</em></p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2022-01-16-confusion_gears/balanced_cf-480.webp 480w,/assets/img/posts/2022-01-16-confusion_gears/balanced_cf-800.webp 800w,/assets/img/posts/2022-01-16-confusion_gears/balanced_cf-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/posts/2022-01-16-confusion_gears/balanced_cf.png" class="img-fluid rounded z-depth-1" width="50%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p style="color:gray; font-size: 100%; text-align: center;"><em>Figure 2: Confustion star.</em></p> <p>When small errors hinder the visualization, it is possible to employ the <strong>logarithm of the error matrix</strong>, see Figure 3. Here, the center of the circle does not correspond to a null error but to an arbitrarily chosen small value (0.01 in the graphic).</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2022-01-16-confusion_gears/balanced_cf_log-480.webp 480w,/assets/img/posts/2022-01-16-confusion_gears/balanced_cf_log-800.webp 800w,/assets/img/posts/2022-01-16-confusion_gears/balanced_cf_log-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/posts/2022-01-16-confusion_gears/balanced_cf_log.png" class="img-fluid rounded z-depth-1" width="50%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p style="color:gray; font-size: 100%; text-align: center;"><em>Figure 3: Logarithmic confusion star.</em></p> <h4 id="confusion-star-for-understanding-the-learning-process">Confusion star for understanding the learning process</h4> <p>Comparing confusion stars at <strong>different number of training data</strong> can be useful to understand the learning process in addition to the <strong>learning curve</strong>, see Figure 4.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2022-01-16-confusion_gears/learning_curve-480.webp 480w,/assets/img/posts/2022-01-16-confusion_gears/learning_curve-800.webp 800w,/assets/img/posts/2022-01-16-confusion_gears/learning_curve-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/posts/2022-01-16-confusion_gears/learning_curve.png" class="img-fluid rounded z-depth-1" width="50%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p style="color:gray; font-size: 100%; text-align: center;"><em>Figure 4: Learning curve of the MNIST dataset using a neural network with a single 128-neurons hidden layer.</em></p> <p>Consider the significant increasing in the accuracy occurring around 500 training instances. While the <strong>learning curve does not detail what this improvement is due to or how it is distributed</strong> in each of the classes, an analysis of the confusion stars can shed more light on the question.</p> <p>In Figure 5 the confusion stars corresponding to a point with 502 samples (before the jump, accuracy of 38%) and another point with 610 samples (after the jump, accuracy of 67%) are shown. Quite important improvements (smaller errors) can be observed in, for example, the 0 classified as a 2, the 2 classified as a 1, and so on. In other words, <strong>the representation of the confusion matrix not only informs us of the overall improvement of the classifier, but also of how this improvement is distributed.</strong></p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2022-01-16-confusion_gears/learning_cf-480.webp 480w,/assets/img/posts/2022-01-16-confusion_gears/learning_cf-800.webp 800w,/assets/img/posts/2022-01-16-confusion_gears/learning_cf-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/posts/2022-01-16-confusion_gears/learning_cf.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p style="color:gray; font-size: 100%; text-align: center;"><em>Figure 5: Confusion stars (in logarithmic scale) corresponding to a pair of points before and after the first jump in the learning curve: 502 instances (left; accuracy of 38.13%) and 610 instances (right; accuracy of 67.23%).</em></p> <h2 id="confusion-gear-plot">Confusion gear plot</h2> <p>The confusion gear plot depicts the <strong>non-diagonal elements of the hits matrix</strong> \(\mathbf{HM}\) or \(\boldsymbol{\Psi}\) in a circle. So, we have a visual inspection of the <strong>classification hits from one class relative to all other ones</strong>. Like the confusion star, the circle is divided in \(C\) arcs (one for each class), and each arc is again divided in \(C-1\) sectors (all but the sector corresponding to the relative arc’s class).</p> <p>Figure 6 depicts the confusion gear for the MNIST example. Consider again <strong>class 2</strong> as reference. Here, we se lower values corresponding to class 1 and class 7, according to the higher errors found in Figure 2 or Figure 3. We remark that a <strong>perfect classification will results in a full confusion gear</strong><em>.</em></p> <p>Since the hits are usually not so small, there is no need to consider logarithm transformations as in confusion stars.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2022-01-16-confusion_gears/confusion_gear-480.webp 480w,/assets/img/posts/2022-01-16-confusion_gears/confusion_gear-800.webp 800w,/assets/img/posts/2022-01-16-confusion_gears/confusion_gear-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/posts/2022-01-16-confusion_gears/confusion_gear.png" class="img-fluid rounded z-depth-1" width="50%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p style="color:gray; font-size: 100%; text-align: center;"><em>Figure 6: Confusion gear.</em></p> <h2 id="conclusions">Conclusions</h2> <p>A new way of representing the information conveyed by confusion matrices is proposed in the form of a <strong>confusion star</strong> (focusing on the errors) or a <strong>confusion gear</strong> (centered on the hits). The new tools successfully represents <strong>multiclass classification results in the form of a radial plot.</strong></p> <p>The traditional way to represent confusion matrix uses colors (and eventually texts) to indicate the number of instances belonging to an actual class that are classified to an estimated class. Instead, confusion stars and gears <strong>use shapes to convey that information</strong>. Changing colors by shapes significantly improves the readability of the proposed graphics.</p> <p>An additional property of the confusion stars and gears is that <strong>the enclosed area provides information about the overall classification performance</strong>. The relation of these areas to standard classification metrics has also been derived.</p> <p>Finally, the new graphic tools can usefully be employed to <strong>visualize the performance of a sequence of classifiers.</strong></p> <h2 id="references">References</h2> <p>[1] A. Luque, M. Mazzoleni, A. Carrasco and A. Ferramosca, “Visualizing Classification Results: Confusion Star and Confusion Gear,” in <em>IEEE Access</em>, vol. 10, pp. 1659-1677, 2022, doi: 10.1109/ACCESS.2021.3137630.</p> <p>[2] L. Deng, “The MNIST Database of Handwritten Digit Images for Machine Learning Research [Best of the Web],” in <em>IEEE Signal Processing Magazine</em>, vol. 29, no. 6, pp. 141-142, Nov. 2012, doi: 10.1109/MSP.2012.2211477.</p>]]></content><author><name>Mirko Mazzoleni</name></author><category term="research"/><category term="visualization"/><summary type="html"><![CDATA[Authors: Amalia Luque\(^1\), Mirko Mazzoleni\(^2\), Alejandro Carrasco\(^3\) and Antonio Ferramosca\(^2\) \(^1\) Departamento de Ingeniería del Diseño, Escuela Politécnica Superior, Universidad de Sevilla, 41011 Seville, Spain \(^2\) Department of Management, Information and Production Engineering, University of Bergamo, 24044 Dalmine, Italy \(^3\) Departamento de Tecnología Electrónica, School of Computer Engineering, Universidad de Sevilla, 41012 Seville, Spain In this post, we present two new visualization tools, called confusion star and confusion gear, for the representation of classification performance of multiclass classifiers. More details can be found in the paper [1]: Open-access paper on IEEE Access Python code Github repository You can cite the paper as: @ARTICLE{9658486, author={Luque, Amalia and Mazzoleni, Mirko and Carrasco, Alejandro and Ferramosca, Antonio}, journal={IEEE Access}, title={Visualizing Classification Results: Confusion Star and Confusion Gear}, year={2022}, volume={10}, number={}, pages={1659-1677}, doi={10.1109/ACCESS.2021.3137630}} Matrices for representing classification results We start our discussion by presenting three matrices: the confusion matrix, used to represent the number of correctly and incorrectly classified instances; the hits matrix, used to represent the number of correctly classified instances; the errors matrix, used to represent the number of incorrectly classified instances. Confusion matrix Classification results from machine learning algorithms are commonly summarized in the form of a confusion matrix, especially for representing a dichotomous (\(2\)-classes) classification tasks. As the name suggests, a confusion matrix is a table representing the number of correctly and incorrectly classified instances, see Table 1. Table 1: Binary confusion matrix for a \(2\)-classes classification task In the two-classes case, this matrix representation is visually effective: it is immediately clear if the classifier is performing well, as the number of false positives and false negatives should be as low as possible. However, this representation suffers when more than two classes are present. A simple way to visualize the results of a \(C\)-classes classification problem (when \(C&gt;2\)) would be to employ a one-vs-all strategy: select a class to be the “Positive” one. All the other classes will constitute the “Negative” class; build a binary confusion matrix representing the Positive vs. Negative classes. Repeat this process until all classes played the role of the “Positive” one; visualize the \(C\) binary confusion matrices. While easy to perform, this one-vs-all representation is far less effective. As an example, consider the famous MNIST (Modified National Institute of Standards and Technology) [2], that contains 70.000 images, each of them representing an handwritten digit (0 to 9). We trained a shallow MLP (Multi-Layer Perceptron) neural network on the first 60.000 images, and evaluated its results on the remaining 10.000 images. In the MNIST case, \(C=10\) figures have to be depicted and the overall algorithm performance is difficult to evaluate. Figure 1 shows the \(10\) confusion matrices, with cell elements expressed as percentages normalized by column (the actual class). Figure 1: Unit binary confusion matrices for MNIST test data. In order to understand the performance of the classifier upon \(10\) classes, we have to look at each confusion matrix singularly. An overall interpretation is possible but rather difficult. Instead of visualizing multiple classification matrices, we propose two new visualizations for better assessing the classification performance of a multiclass classifier: Confusion star: focused on representing classification errors (the lower the better) for each class; Confusion gears: focused on representing classification hits (the higher the better) for each class. First, we need to introduce what errors matrix and hits matrix are. Errors matrix Suppose to have at disposal the confusion matrix of a \(3\)-class classification task as \[\mathbf{CM} \equiv \begin{bmatrix} m_{11} &amp; m_{12} &amp; m_{13} \\ m_{21} &amp; m_{22} &amp; m_{23} \\ m_{31} &amp; m_{23} &amp; m_{33} \\ \end{bmatrix}\] where \(m_{ij}\) is the number of instances of the \(j\)-th class classified to the \(i\)-th class. Ideally, for a perfect classification, we want \(m_{ij}=0\) for \(i\neq j\). The total number of instances classified to the \(i\)-th class is the sum of the \(i\)-th row of the confusion matrix, that is \[m_i = \sum_{j=1}^{C} m_{ij}\] The errors matrix is defined by the \(i,j\) elements \[e_{ij} \equiv \begin{cases} m_i - m_{ii} &amp; i=j \\ m_{ij} &amp; i\neq j \end{cases}\] so that, in our example, we get \[\mathbf{EM} \equiv \begin{bmatrix} e_{11} &amp; e_{12} &amp; e_{13} \\ e_{21} &amp; e_{22} &amp; e_{23} \\ e_{31} &amp; e_{32} &amp; e_{33} \\ \end{bmatrix} = \begin{bmatrix} m_{1}-m_{11} &amp; m_{12} &amp; m_{13} \\ m_{21} &amp; m_2-m_{22} &amp; m_{23} \\ m_{31} &amp; m_{32} &amp; m_3-m_{33} \\ \end{bmatrix}\] Here, a perfect classification means \(e_{ij}=0\) for all \(i,j\), i.e. \(m_{ij}=0\) (no misclassifications), so that \[\mathbf{EM} = \begin{bmatrix} 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 \\ \end{bmatrix}\] The \(i\)-th row \(\mathbf{EM}_i\) of this matrix can also be formulated in terms of the ratio over the total number of instances belonging to the \(i\)-th class \[\mathbf{EM}_i \equiv \begin{bmatrix} \epsilon_{i1}\cdot m_i &amp; \epsilon_{i2}\cdot m_i &amp; \epsilon_{i3}\cdot m_i \end{bmatrix}\] where \(\epsilon_{ij}=e_{ij}/m_i\). The matrix \(\mathbf{E}=\{\psi_{ij}\}\) is called the unit errors matrix, and it is a normalized version (entries with values 0-1) of the original hit matrix. The unit errors matrix allows to reason in 0-100% percentages or errors. Hits matrix The hits matrix is defined by the \(i,j\) elements \[w_{ij} \equiv \begin{cases} m_{ii} &amp; i=j \\ m_{i} - m_{ij} &amp; i\neq j \end{cases}\] so that, in our example, we get \[\mathbf{HM} \equiv \begin{bmatrix} w_{11} &amp; w_{12} &amp; w_{13} \\ w_{21} &amp; w_{22} &amp; w_{23} \\ w_{31} &amp; w_{32} &amp; w_{33} \\ \end{bmatrix} = \begin{bmatrix} m_{11} &amp; m_{1} - m_{12} &amp; m_{1} - m_{13} \\ m_{2} - m_{21} &amp; m_{22} &amp; m_{2} - m_{23} \\ m_{3} - m_{31} &amp; m_{3} - m_{32} &amp; m_{33} \\ \end{bmatrix}\] Here, a perfect classification means \(w_{ij}=m_{i}\) for all \(j\), i.e. \(m_{ij}=0\) (no misclassifications), so that \[\mathbf{HM} = \begin{bmatrix} m_{1} &amp; m_1 &amp; m_1 \\ m_2 &amp; m_2 &amp; m_2 \\ m_{3} &amp; m_{3} &amp; w_{3} \\ \end{bmatrix}\] The \(i\)-th row \(\mathbf{HM}_i\) of this matrix can also be formulated in terms of the ratio over the total number of instances belonging to the \(i\)-th class \[\mathbf{HM}_i \equiv \begin{bmatrix} \psi_{i1}\cdot m_i &amp; \psi_{i2}\cdot m_i &amp; \psi_{i3}\cdot m_i \end{bmatrix}\] where \(\psi_{ij}=w_{ij}/m_i\). The matrix \(\boldsymbol{\Psi}=\{\psi_{ij}\}\) is called the unit hits matrix, and it is a normalized version (entries with values 0-1) of the original hit matrix. The unit hits matrix allows to reason in 0-100% percentages of correct classifications. Confusion star plot The confusion star plot depicts the non-diagonal elements of the errors matrix \(\mathbf{EM}\) or \(\mathbf{E}\) in a circle. So, we have a visual inspection of the classification errors from one class relative to all other ones. The circle is divided in \(C\) arcs (one for each class), and each arc is again divided in \(C-1\) sectors (all but the sector corresponding to the relative arc’s class). Confusion star for final classification performance Figure 2 shows the confusion star based on the unit errors matrix of the model trained on the MNIST dataset. We have \(C=10\) arcs, named from 0 to 9. Then, each arc has \(C-1=9\) sectors, each one numbered from 0 to 9 but without the corresponding class of that arc. Consider for instance class 0 and class 2. Here, it is immediate to observe how class 0 instances are mostly confused with class 5 ones, and that class 2 struggles with class 1 and class 7. We remark that a perfect classification will results in an empty confusion star. Figure 2: Confustion star. When small errors hinder the visualization, it is possible to employ the logarithm of the error matrix, see Figure 3. Here, the center of the circle does not correspond to a null error but to an arbitrarily chosen small value (0.01 in the graphic). Figure 3: Logarithmic confusion star. Confusion star for understanding the learning process Comparing confusion stars at different number of training data can be useful to understand the learning process in addition to the learning curve, see Figure 4. Figure 4: Learning curve of the MNIST dataset using a neural network with a single 128-neurons hidden layer. Consider the significant increasing in the accuracy occurring around 500 training instances. While the learning curve does not detail what this improvement is due to or how it is distributed in each of the classes, an analysis of the confusion stars can shed more light on the question. In Figure 5 the confusion stars corresponding to a point with 502 samples (before the jump, accuracy of 38%) and another point with 610 samples (after the jump, accuracy of 67%) are shown. Quite important improvements (smaller errors) can be observed in, for example, the 0 classified as a 2, the 2 classified as a 1, and so on. In other words, the representation of the confusion matrix not only informs us of the overall improvement of the classifier, but also of how this improvement is distributed. Figure 5: Confusion stars (in logarithmic scale) corresponding to a pair of points before and after the first jump in the learning curve: 502 instances (left; accuracy of 38.13%) and 610 instances (right; accuracy of 67.23%). Confusion gear plot The confusion gear plot depicts the non-diagonal elements of the hits matrix \(\mathbf{HM}\) or \(\boldsymbol{\Psi}\) in a circle. So, we have a visual inspection of the classification hits from one class relative to all other ones. Like the confusion star, the circle is divided in \(C\) arcs (one for each class), and each arc is again divided in \(C-1\) sectors (all but the sector corresponding to the relative arc’s class). Figure 6 depicts the confusion gear for the MNIST example. Consider again class 2 as reference. Here, we se lower values corresponding to class 1 and class 7, according to the higher errors found in Figure 2 or Figure 3. We remark that a perfect classification will results in a full confusion gear. Since the hits are usually not so small, there is no need to consider logarithm transformations as in confusion stars. Figure 6: Confusion gear. Conclusions A new way of representing the information conveyed by confusion matrices is proposed in the form of a confusion star (focusing on the errors) or a confusion gear (centered on the hits). The new tools successfully represents multiclass classification results in the form of a radial plot. The traditional way to represent confusion matrix uses colors (and eventually texts) to indicate the number of instances belonging to an actual class that are classified to an estimated class. Instead, confusion stars and gears use shapes to convey that information. Changing colors by shapes significantly improves the readability of the proposed graphics. An additional property of the confusion stars and gears is that the enclosed area provides information about the overall classification performance. The relation of these areas to standard classification metrics has also been derived. Finally, the new graphic tools can usefully be employed to visualize the performance of a sequence of classifiers. References [1] A. Luque, M. Mazzoleni, A. Carrasco and A. Ferramosca, “Visualizing Classification Results: Confusion Star and Confusion Gear,” in IEEE Access, vol. 10, pp. 1659-1677, 2022, doi: 10.1109/ACCESS.2021.3137630. [2] L. Deng, “The MNIST Database of Handwritten Digit Images for Machine Learning Research [Best of the Web],” in IEEE Signal Processing Magazine, vol. 29, no. 6, pp. 141-142, Nov. 2012, doi: 10.1109/MSP.2012.2211477.]]></summary></entry><entry><title type="html">Human perception of probability</title><link href="https:/mirkomazzoleni.github.io/blog/2016/perception_of_probability/" rel="alternate" type="text/html" title="Human perception of probability"/><published>2016-12-17T00:00:00+00:00</published><updated>2016-12-17T00:00:00+00:00</updated><id>https:/mirkomazzoleni.github.io/blog/2016/perception_of_probability</id><content type="html" xml:base="https:/mirkomazzoleni.github.io/blog/2016/perception_of_probability/"><![CDATA[<p>Back in 1964, <a href="https://en.wikipedia.org/wiki/Sherman_Kent">Sherman Kent</a> tried to address the problem of misleading odds expressions in <a href="https://en.wikipedia.org/wiki/National_Intelligence_Estimate">National Intelligence Estimates</a> (NIE). Recognizing communication problems caused by imprecise probablistic statements, Kent proposed a schema for standardizing the uncertainty ranges associated with words used to communicate the likelihood of an event. In his work <a href="https://www.cia.gov/library/center-for-the-study-of-intelligence/csi-publications/books-and-monographs/sherman-kent-and-the-board-of-national-estimates-collected-essays/6words.html">Words of Estimative Probability</a>, the author defined five ranges of uncertainty and related expressions to convey them:</p> <ol> <li><strong>Almost Certain</strong>: \(93\% \pm 6\%\)</li> <li><strong>Probable</strong>: \(75\% \pm 12\%\)</li> <li><strong>Chances About Even</strong>: \(50\% \pm 10\%\)</li> <li><strong>Probably Not</strong>: \(30\% \pm 10\%\)</li> <li><strong>Almost Certainly Not</strong>: \(7\% \pm 5\%\)</li> </ol> <p>Kent defined also a set of equivalent expressions with respect to the ones defined previously:</p> <ol> <li><strong>Almost Certain</strong>: virtually certain, highly probable, highly likely, odds (or chances) overwhelming</li> <li><strong>Probable</strong>: likely, we believe, we estimate</li> <li><strong>Chances About Even</strong>: chances a little better (or less) than even, improbable, unlikely</li> <li><strong>Probably Not</strong>: we believe that…not, we estimate that…not, we doubt, doubtful</li> <li><strong>Almost Certainly Not</strong>: virtually impossible, almost impossible, some slight chance, highly doubtful</li> </ol> <p><a href="https://www.cia.gov/library/center-for-the-study-of-intelligence/csi-publications/books-and-monographs/psychology-of-intelligence-analysis/art15.html#rft144">This article</a> describes an experiment that was performed with 23 NATO military officers accustomed to reading intelligence reports. They were given a number of sentences such as: “It is highly unlikely that…”: all the sentences were the same except that the verbal expressions of probability changed. The officers were asked what percentage probability they would attribute to each statement if they read it in an intelligence report. Each dot in the table represents one officer’s probability assignment. While there was broad consensus about the meaning of “better than even”, there was a wide disparity in interpretation of other probability expressions. The shaded areas in the table show the ranges proposed by Kent.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2016-12-17-perception_of_probability/perception-480.webp 480w,/assets/img/posts/2016-12-17-perception_of_probability/perception-800.webp 800w,/assets/img/posts/2016-12-17-perception_of_probability/perception-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/posts/2016-12-17-perception_of_probability/perception.gif" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>The experiment showed how the probabilities conveyed by different expressions could be perceived by a human. In <a href="https://www.reddit.com/r/dataisbeautiful/comments/3hi7ul/oc_what_someone_interprets_when_you_say_probably/">this</a> Reddit thread, the <a href="https://www.reddit.com/user/zonination">author</a> replicated the experiment by collecting data via subreddit <a href="https://www.reddit.com/r/samplesize">r/samplesize</a>. The data can be found <a href="https://github.com/zonination/perceptions">here</a>. By visualizing the notched boxplots, the results match very well the previous CIA’s experiment.</p> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Import files, load plot and data packages</span><span class="w">
</span><span class="n">probly</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="s2">"probly.csv"</span><span class="p">,</span><span class="w"> </span><span class="n">stringsAsFactors</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">reshape2</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">scales</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">RColorBrewer</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">ggthemes</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Melt data into column format.</span><span class="w">
</span><span class="n">probly</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">melt</span><span class="p">(</span><span class="n">probly</span><span class="p">)</span><span class="w">
</span><span class="n">probly</span><span class="o">$</span><span class="n">variable</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">gsub</span><span class="p">(</span><span class="s2">"[.]"</span><span class="p">,</span><span class="s2">" "</span><span class="p">,</span><span class="n">probly</span><span class="o">$</span><span class="n">variable</span><span class="p">)</span><span class="w">


</span><span class="c1"># Reorder probability levels</span><span class="w">
</span><span class="n">probly</span><span class="o">$</span><span class="n">variable</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">probly</span><span class="o">$</span><span class="n">variable</span><span class="p">,</span><span class="w">
                          </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Chances Are Slight"</span><span class="p">,</span><span class="w">
                            </span><span class="s2">"Highly Unlikely"</span><span class="p">,</span><span class="w">
                            </span><span class="s2">"Almost No Chance"</span><span class="p">,</span><span class="w">
                            </span><span class="s2">"Little Chance"</span><span class="p">,</span><span class="w">
                            </span><span class="s2">"Probably Not"</span><span class="p">,</span><span class="w">
                            </span><span class="s2">"Unlikely"</span><span class="p">,</span><span class="w">
                            </span><span class="s2">"Improbable"</span><span class="p">,</span><span class="w">
                            </span><span class="s2">"We Doubt"</span><span class="p">,</span><span class="w">
                            </span><span class="s2">"About Even"</span><span class="p">,</span><span class="w">
                            </span><span class="s2">"Better Than Even"</span><span class="p">,</span><span class="w">
                            </span><span class="s2">"Probably"</span><span class="p">,</span><span class="w">
                            </span><span class="s2">"We Believe"</span><span class="p">,</span><span class="w">
                            </span><span class="s2">"Likely"</span><span class="p">,</span><span class="w">
                            </span><span class="s2">"Probable"</span><span class="p">,</span><span class="w">
                            </span><span class="s2">"Very Good Chance"</span><span class="p">,</span><span class="w">
                            </span><span class="s2">"Highly Likely"</span><span class="p">,</span><span class="w">
                            </span><span class="s2">"Almost Certainly"</span><span class="p">))</span><span class="w">
</span></code></pre></div></div> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#Plot probability data</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">probly</span><span class="p">,</span><span class="n">aes</span><span class="p">(</span><span class="n">reorder</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">FUN</span><span class="o">=</span><span class="n">median</span><span class="p">),</span><span class="n">value</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_boxplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">variable</span><span class="p">),</span><span class="n">alpha</span><span class="o">=</span><span class="m">.5</span><span class="p">,</span><span class="w"> </span><span class="n">notch</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_jitter</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">variable</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="m">4</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="m">.2</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">coord_flip</span><span class="p">()</span><span class="o">+</span><span class="w">
  </span><span class="n">guides</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"Sentence"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"Assigned Probability (%)"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">theme_few</span><span class="p">(</span><span class="n">base_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">panel.border</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_blank</span><span class="p">())</span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">panel.grid.major.x</span><span class="w"> </span><span class="o">=</span><span class="n">element_line</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">"grey90"</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="m">.25</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_y_continuous</span><span class="p">(</span><span class="n">breaks</span><span class="o">=</span><span class="n">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">100</span><span class="p">,</span><span class="m">10</span><span class="p">))</span><span class="w">
</span></code></pre></div></div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2016-12-17-perception_of_probability/perception_boxplots.svg-480.webp 480w,/assets/img/posts/2016-12-17-perception_of_probability/perception_boxplots.svg-800.webp 800w,/assets/img/posts/2016-12-17-perception_of_probability/perception_boxplots.svg-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/posts/2016-12-17-perception_of_probability/perception_boxplots.svg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>From the graph, several things draw the attention. Particularly interesting are the outliers of terms such as:</p> <ul> <li>“Highly likely” at \(15\%\)</li> <li>“We believe” and “Better than even” at \(5\%\)</li> </ul> <p>and, from the opposite side:</p> <ul> <li>“Probably not”, “We doubt”, “Little chance” at \(100\%\)</li> <li>“Highly unlikely”, “Almost no chance” at \(90-95\%\)</li> </ul> <p>An interesting question could be to investigate how and what people’s experiences lead to such out-of-box judgements! The notched boxplots permit to compare groups: if the notches of two boxes do not overlap, this suggests that the medians are significantly different. The notches represents an <a href="http://stats.stackexchange.com/questions/184516/why-is-the-95-ci-for-the-median-supposed-to-be-%C2%B11-57iqr-sqrtn">empirical</a> \(95\%\) confindence interval on the group median. It is then possible to visually cluster the expressions:</p> <ol> <li>Highly Likely, Almost Certainly</li> <li>Probably, We Believe, Likely, Probable, Very Good Chance</li> <li>About Even, Better Than Even</li> <li>Chances Are Slight, Little Chance, Probably Not, Unlikely, Improbable, We Doubt</li> <li>Almost No Chance, Highly Unlikely</li> </ol> <p>Starting from similar analysis, the book <a href="https://www.amazon.com/Critical-Thinking-Strategic-Intelligence-Katherine/dp/1452226679/ref=sr_1_2?ie=UTF8&amp;qid=1481480362&amp;sr=8-2&amp;keywords=Critical+Thinking+For+Strategic+Intelligence">Critical Thinking For Strategic Intelligence</a> provides some guidelines for analysts who need to translate their findings to the general public, for example:</p> <ul> <li>Try to minimize use of such words as <em>might</em> or <em>could</em> because sentences that contain them usually convey little useful information to the reader</li> <li>The best way to convey a level of likelihood is to follow the probabilistic word, percentage, or bettor’s odd with the word <em>because</em> and a response to complete the sentence that includes a list of key factors that support the judgement</li> <li>A good technique for assessing the soundness of a numeric probability judgement is to check if the percentage of a hypothesis being wrong and the percentage of it being right add to 100</li> <li>The key to presenting levels of confidence is for analysts to state not just how confident they are as analysts, but why they are confident</li> <li>A source summary statement is a powerful tool for giving readers an overall sense of an analyst’s level of confidence and the quality of the sources used to support the analysis before they start reading the paper</li> </ul> <p>In conclusion, by providing the customers with explicit language laying out why a specific word or percentage was selected, they can make their own independent calculations of the probability of event occurring. The analyst, having knowledge of how a specific sentence is interpreted, can refine his language to better convey information.</p> <p>The entire code for this post can be found <a href="https://github.com/MirkoMazzoleni/MirkoMazzoleni.github.io/blob/master/Rmarkdowns/2016-12-17-perception_of_probability.Rmd">here</a>.</p>]]></content><author><name>Mirko Mazzoleni</name></author><category term="fun"/><category term="visualization"/><category term="R"/><summary type="html"><![CDATA[Back in 1964, Sherman Kent tried to address the problem of misleading odds expressions in National Intelligence Estimates (NIE). Recognizing communication problems caused by imprecise probablistic statements, Kent proposed a schema for standardizing the uncertainty ranges associated with words used to communicate the likelihood of an event. In his work Words of Estimative Probability, the author defined five ranges of uncertainty and related expressions to convey them: Almost Certain: \(93\% \pm 6\%\) Probable: \(75\% \pm 12\%\) Chances About Even: \(50\% \pm 10\%\) Probably Not: \(30\% \pm 10\%\) Almost Certainly Not: \(7\% \pm 5\%\) Kent defined also a set of equivalent expressions with respect to the ones defined previously: Almost Certain: virtually certain, highly probable, highly likely, odds (or chances) overwhelming Probable: likely, we believe, we estimate Chances About Even: chances a little better (or less) than even, improbable, unlikely Probably Not: we believe that…not, we estimate that…not, we doubt, doubtful Almost Certainly Not: virtually impossible, almost impossible, some slight chance, highly doubtful This article describes an experiment that was performed with 23 NATO military officers accustomed to reading intelligence reports. They were given a number of sentences such as: “It is highly unlikely that…”: all the sentences were the same except that the verbal expressions of probability changed. The officers were asked what percentage probability they would attribute to each statement if they read it in an intelligence report. Each dot in the table represents one officer’s probability assignment. While there was broad consensus about the meaning of “better than even”, there was a wide disparity in interpretation of other probability expressions. The shaded areas in the table show the ranges proposed by Kent. The experiment showed how the probabilities conveyed by different expressions could be perceived by a human. In this Reddit thread, the author replicated the experiment by collecting data via subreddit r/samplesize. The data can be found here. By visualizing the notched boxplots, the results match very well the previous CIA’s experiment. # Import files, load plot and data packages probly &lt;- read.csv("probly.csv", stringsAsFactors=FALSE) library(ggplot2) library(reshape2) library(scales) library(RColorBrewer) library(ggthemes) # Melt data into column format. probly &lt;- melt(probly) probly$variable &lt;- gsub("[.]"," ",probly$variable) # Reorder probability levels probly$variable &lt;- factor(probly$variable, c("Chances Are Slight", "Highly Unlikely", "Almost No Chance", "Little Chance", "Probably Not", "Unlikely", "Improbable", "We Doubt", "About Even", "Better Than Even", "Probably", "We Believe", "Likely", "Probable", "Very Good Chance", "Highly Likely", "Almost Certainly")) #Plot probability data ggplot(probly,aes(reorder(variable, value, FUN=median),value))+ geom_boxplot(aes(fill=variable),alpha=.5, notch=TRUE)+ geom_jitter(aes(color=variable),size=4,alpha=.2)+ coord_flip()+ guides(fill=FALSE,color=FALSE)+ xlab("Sentence")+ ylab("Assigned Probability (%)")+ theme_few(base_size = 16)+ theme(panel.border = element_blank())+ theme(panel.grid.major.x =element_line(color="grey90",size=.25)) + scale_y_continuous(breaks=seq(0,100,10)) From the graph, several things draw the attention. Particularly interesting are the outliers of terms such as: “Highly likely” at \(15\%\) “We believe” and “Better than even” at \(5\%\) and, from the opposite side: “Probably not”, “We doubt”, “Little chance” at \(100\%\) “Highly unlikely”, “Almost no chance” at \(90-95\%\) An interesting question could be to investigate how and what people’s experiences lead to such out-of-box judgements! The notched boxplots permit to compare groups: if the notches of two boxes do not overlap, this suggests that the medians are significantly different. The notches represents an empirical \(95\%\) confindence interval on the group median. It is then possible to visually cluster the expressions: Highly Likely, Almost Certainly Probably, We Believe, Likely, Probable, Very Good Chance About Even, Better Than Even Chances Are Slight, Little Chance, Probably Not, Unlikely, Improbable, We Doubt Almost No Chance, Highly Unlikely Starting from similar analysis, the book Critical Thinking For Strategic Intelligence provides some guidelines for analysts who need to translate their findings to the general public, for example: Try to minimize use of such words as might or could because sentences that contain them usually convey little useful information to the reader The best way to convey a level of likelihood is to follow the probabilistic word, percentage, or bettor’s odd with the word because and a response to complete the sentence that includes a list of key factors that support the judgement A good technique for assessing the soundness of a numeric probability judgement is to check if the percentage of a hypothesis being wrong and the percentage of it being right add to 100 The key to presenting levels of confidence is for analysts to state not just how confident they are as analysts, but why they are confident A source summary statement is a powerful tool for giving readers an overall sense of an analyst’s level of confidence and the quality of the sources used to support the analysis before they start reading the paper In conclusion, by providing the customers with explicit language laying out why a specific word or percentage was selected, they can make their own independent calculations of the probability of event occurring. The analyst, having knowledge of how a specific sentence is interpreted, can refine his language to better convey information. The entire code for this post can be found here.]]></summary></entry><entry><title type="html">The three ways of statistical inference</title><link href="https:/mirkomazzoleni.github.io/blog/2016/three_ways_of_inference/" rel="alternate" type="text/html" title="The three ways of statistical inference"/><published>2016-11-28T00:00:00+00:00</published><updated>2016-11-28T00:00:00+00:00</updated><id>https:/mirkomazzoleni.github.io/blog/2016/three_ways_of_inference</id><content type="html" xml:base="https:/mirkomazzoleni.github.io/blog/2016/three_ways_of_inference/"><![CDATA[<p>I recently skipped through the course <a href="https://www.coursera.org/learn/statistical-inferences"><em>Improving your statistical inferences</em></a>, held on the <a href="https://www.coursera.org/">Coursera</a> MOOC platform. The lessons are taught by Daniel Lakens, associate professor at the department of Human-Technology Interaction, Eindhoven University of Technology.</p> <p>I’ve found fascinating his comparison about the different conceptual frameworks of statistical inference that exist nowadays. Considering the following yoga philosophies, the <a href="https://en.wikipedia.org/wiki/Three_Yogas">three paths of realization</a> are:</p> <ul> <li>The <strong>Karma</strong> yoga</li> <li>The <strong>Jnana</strong> yoga</li> <li>The <strong>Bhakti</strong> yoga</li> </ul> <p>These disciplines entail different meanings. Respectively, they are known as:</p> <ul> <li>The path of <strong>Action</strong></li> <li>The path of <strong>Knowledge</strong></li> <li>The path of <strong>Devotion</strong></li> </ul> <p>But what does this have in common with statistical inference? In day-by-day work, the researcher faces three fundamental questions:</p> <ul> <li>What should I <strong>do</strong>?</li> <li>What’s the <strong>relative evidence</strong>?</li> <li>What should I <strong>believe</strong>?</li> </ul> <p>The Path of Action gives us a guideline to act. It searches for rules to govern our behavior such that, in the long run, we will not be wrong too often. This is the hypothesis testing framework. The well known problem with NHST (Null Hypothesis Significance Testing) is that a rule to govern our behavior in the long run, tells us nothing about the current test.</p> <p>The Path of Knowledge is based on actually observed data (which is what matters isn’t it?). Standing on the concept of Likelihoods, the aim here is to compare the likelihood of different hypothesis via the likelihood ratio, given the data (and the chosen model). A discussion on the likelihood approach to inference can be found in the textbook <a href="https://www.amazon.com/Statistical-Evidence-Likelihood-Monographs-Probability/dp/0412044110/ref=sr_1_1?s=books&amp;ie=UTF8&amp;qid=1480364103&amp;sr=1-1&amp;keywords=Statistical+Evidence%3A+A+Likelihood+Paradigm">Statistical Evidence: A Likelihood Paradigm</a> by Richard Royall (1997).</p> <p>We arrived, finally, to the last way: the Path of Devotion. Here, personal experience, intuition and previous knowledge can be leveraged to assess the evidence degrees of belief. Based on likelihoods, it lets us to incorporate prior information on our computations. Bayes factors, the relative evidence for one model to another, is used to compare the different hypothesis. Bayesian inference can be obviously used to perform parameter estimation, specifying in the same way a prior distribution on possible parameters values. The book <a href="https://www.amazon.com/Doing-Bayesian-Data-Analysis-Second/dp/0124058884/ref=sr_1_1?ie=UTF8&amp;qid=1480365777&amp;sr=8-1&amp;keywords=doing+bayesian+data+analysis">Doing Bayesian Data Analysis</a>, by John Kruschke (2014), is an excellent practical guide to get started with modern Bayesian procedures.</p> <p>Concluding, statistical inference frameworks can be thought in light of the three yoga paths:</p> <ul> <li>The path of <strong>Action</strong>: Neyman-Pearson</li> <li>The path of <strong>Knowledge</strong>: Likelihoods</li> <li>The path of <strong>Devotion</strong>: Bayesian statistics</li> </ul> <p>The presented material is borrowed from the course taught by Daniel Lakens. Definitely a must follow course, full of inspiring insights as the presented ones.</p>]]></content><author><name>Mirko Mazzoleni</name></author><category term="thoughts"/><summary type="html"><![CDATA[I recently skipped through the course Improving your statistical inferences, held on the Coursera MOOC platform. The lessons are taught by Daniel Lakens, associate professor at the department of Human-Technology Interaction, Eindhoven University of Technology. I’ve found fascinating his comparison about the different conceptual frameworks of statistical inference that exist nowadays. Considering the following yoga philosophies, the three paths of realization are: The Karma yoga The Jnana yoga The Bhakti yoga These disciplines entail different meanings. Respectively, they are known as: The path of Action The path of Knowledge The path of Devotion But what does this have in common with statistical inference? In day-by-day work, the researcher faces three fundamental questions: What should I do? What’s the relative evidence? What should I believe? The Path of Action gives us a guideline to act. It searches for rules to govern our behavior such that, in the long run, we will not be wrong too often. This is the hypothesis testing framework. The well known problem with NHST (Null Hypothesis Significance Testing) is that a rule to govern our behavior in the long run, tells us nothing about the current test. The Path of Knowledge is based on actually observed data (which is what matters isn’t it?). Standing on the concept of Likelihoods, the aim here is to compare the likelihood of different hypothesis via the likelihood ratio, given the data (and the chosen model). A discussion on the likelihood approach to inference can be found in the textbook Statistical Evidence: A Likelihood Paradigm by Richard Royall (1997). We arrived, finally, to the last way: the Path of Devotion. Here, personal experience, intuition and previous knowledge can be leveraged to assess the evidence degrees of belief. Based on likelihoods, it lets us to incorporate prior information on our computations. Bayes factors, the relative evidence for one model to another, is used to compare the different hypothesis. Bayesian inference can be obviously used to perform parameter estimation, specifying in the same way a prior distribution on possible parameters values. The book Doing Bayesian Data Analysis, by John Kruschke (2014), is an excellent practical guide to get started with modern Bayesian procedures. Concluding, statistical inference frameworks can be thought in light of the three yoga paths: The path of Action: Neyman-Pearson The path of Knowledge: Likelihoods The path of Devotion: Bayesian statistics The presented material is borrowed from the course taught by Daniel Lakens. Definitely a must follow course, full of inspiring insights as the presented ones.]]></summary></entry><entry><title type="html">A Games of Tufte - Part II</title><link href="https:/mirkomazzoleni.github.io/blog/2016/game_of_tufte_part_II/" rel="alternate" type="text/html" title="A Games of Tufte - Part II"/><published>2016-09-20T00:00:00+00:00</published><updated>2016-09-20T00:00:00+00:00</updated><id>https:/mirkomazzoleni.github.io/blog/2016/game_of_tufte_part_II</id><content type="html" xml:base="https:/mirkomazzoleni.github.io/blog/2016/game_of_tufte_part_II/"><![CDATA[<p>The <a href="/blog/2016/game_of_tutfe/">first part</a> of the exploratory data analysis of the Games of Thrones dataset hosted at <a href="https://www.kaggle.com/mylesoneill/game-of-thrones">Kaggle</a> dealt with data understanding and cleaning. This second post digs further into visualization, unveiling interesting aspect of the battles.</p> <p>The entire code for this post can be found <a href="https://github.com/MirkoMazzoleni/MirkoMazzoleni.github.io/blob/master/assets/code/2016-08-05-game_of_tutfe.Rmd">here</a>.</p> <hr/> <h2 id="more-questions">More questions</h2> <p>This section highlights and depicts more questions that arise from the data.</p> <h3 id="major-deaths-and-captures-rate">Major deaths and captures rate</h3> <p>The following plot shows how the major deaths and captures are spread across the battle succession across the years. The major number of them happen in the year \(299\), were almost each battle generates a major death. In the year \(300\), it seems that no more major characters die in battle, with only one of them captured. It can bee seen that the majority of deaths and captures happen in the <em>Riverlands</em> and in the <em>North</em>. From the graph emerges that the cumulated number of deaths is always higher than the cumulated number of captures, symptom that the soldiers prefer to kill rather than take prisoners.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-39-1.svg-480.webp 480w,/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-39-1.svg-800.webp 800w,/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-39-1.svg-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-39-1.svg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h3 id="number-of-battles-won-by-each-commander-when-attacking">Number of battles won by each commander, when attacking</h3> <p>The plots shows the number of won battles by each king, thanks a specific commander, with a different color for each region where the battle was fought. It can be noticed that the Greyjoy’s fought almost in the North, while the Lannister’s and the Stark’s fought all across Westeros. Gregor Clegane (the Mountain) is the commander who won more battles. Folks with no king fought only in the Riverlands.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-40-1.svg-480.webp 480w,/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-40-1.svg-800.webp 800w,/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-40-1.svg-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-40-1.svg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h3 id="type-of-battles-won--by-each-king-when-attacking">Type of battles won by each king, when attacking</h3> <p>The plots shows the number of won battles by each king, thanks a specific tactic, with a different color for each year in which the battle was fought. We can see that Robb Stark preferred to fight with ambushes, while the Lannister’s with pitched battles since the year \(299\), and with sieges from the year \(300\).</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-41-1.svg-480.webp 480w,/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-41-1.svg-800.webp 800w,/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-41-1.svg-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-41-1.svg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h3 id="number-of-battles-fought-in-summer-and-winter">Number of battles fought in summer and winter</h3> <p>The plots shows the number of won battles by each king fought in summer (1) or winter (0), with a different color for each year in which the battle was fought. The poor Robb Stark died during the Red Wedding in year \(299\), so he did not fight any battle during year \(300\). We can see that winter has finally come in year \(300\). Brace yourself!!</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-42-1.svg-480.webp 480w,/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-42-1.svg-800.webp 800w,/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-42-1.svg-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-42-1.svg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h3 id="king-vs-king">King vs. King</h3> <p>This plots shows the preferred king versus whose each king fought his battles.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-43-1.svg-480.webp 480w,/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-43-1.svg-800.webp 800w,/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-43-1.svg-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-43-1.svg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>By inspecting the plot, it seems strange that <em>Balon/Euron Greyjoy</em> attack himself. The battle considered is the <em>Sack of Torrhen’s Square</em>. In fact, the defender king would be <em>Bran Stark</em>, since Robb is dead. I make the decision to substitute the defender king with <em>Robb Stark</em> indicating that the defenders are the Stark’s.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>                      name       attacker_king       defender_king
13 Sack of Torrhen's Square Balon/Euron Greyjoy Balon/Euron Greyjoy
</code></pre></div></div> <p>The correct plot is the following. We can see that Robb Stark fought mainly versus Joffrey Baratheon and viceversa. The troops without a king fought each other. Stannis fought first versus his brother Renly and then versus the Lannister’s.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-45-1.svg-480.webp 480w,/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-45-1.svg-800.webp 800w,/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-45-1.svg-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-45-1.svg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>The previous plots do not change except for those of <strong>Question Q4</strong>, for which the answer remains unchanged. The correct plots are reported here.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-46-1.svg-480.webp 480w,/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-46-1.svg-800.webp 800w,/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-46-1.svg-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-46-1.svg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h3 id="battle-success-given-army-forces">Battle success given army forces</h3> <p>The plot seems to suggest that there is a linear relationship between the size of the attacking army and the size of the defending one, maybe due to information that each rival part has about the other. It seems that after a certain attacker size threshold, the loss is more probable. Maybe is difficult to coordinate such many men, versus a numerous defending army. Having a bigger army, therefore, does not mean to win for sure.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-47-1.svg-480.webp 480w,/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-47-1.svg-800.webp 800w,/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-47-1.svg-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-47-1.svg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h2 id="graph-of-thrones">Graph of Thrones</h2> <p>The following section (which owes a lot to the Kaggle’s user <a href="https://www.kaggle.com/colinfraser/d/mylesoneill/game-of-thrones/battles-investigation">ColinFraser</a>), deals with the use of graph algorithms to analyse the social relations between houses, during the battles. By using the variables <em>attacker_i</em> and <em>defender_i</em>, with \(i=1\dots 4\), is possible to build a graph which vertices are the house names, and an edge is present between two of them if a battle has been fought between the two houses.</p> <p>The direction of the edge is from a loser to a winner, and a darker edge color show how many battles are present with that edge direction (that is, with that battle outcome): the darker, the higher. It can be seen that the Frey’s fought with many houses and won many battles, and how the Nigth’s Watch are isolated from the rest of the world. Interestingly, even the Tyrell’s fought only versus the Greyjoy’s. Both the Tully’s and the Stark’s won more battles versus the Lannister’s with respect to how many they lost versus them, but for the latter house, they are behind the Greyjoy as direct matches won. Interesting is the loop around house Baratheon, which represent the fights of Stannis versus his brother Renly.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-49-1.svg-480.webp 480w,/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-49-1.svg-800.webp 800w,/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-49-1.svg-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-49-1.svg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h3 id="houses-which-won-most">Houses which won most</h3> <p>By counting the in-degree (number of battles won) and the total degree of a node (number of battle fought), is possible to compute how the house performed in terms of efficiency. Since the number of battles for each house is small, we employ the <em>Laplace correction</em> to correct for the small sample size:</p> \[p(win)=\frac{n+1}{n+m+2}\] <p>where \(n\) is the number of won battles, \(m\) is the number of lost battles and \(p(win)\) is the probability to win a battle.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-53-1.svg-480.webp 480w,/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-53-1.svg-800.webp 800w,/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-53-1.svg-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-53-1.svg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h3 id="most-powerful-houses">Most powerful houses</h3> <p>By using the <strong>PageRank</strong> algorithm, it is possible to assign a value to each node in the graph. In the case of Google, each node is a document, a web page, and the edges are links between pages. If a page has an incoming link from an important page, that link carries more value. In our context, we suppose this mean that win against the Lannister’s, for example, carries more value than to win against the Glover’s, and the algorithm is able to exploit this based on the graph structure of won and lost battles (again, incoming and outcoming edges). From Wikipedia:</p> <blockquote> <p>The PageRank algorithm outputs a probability distribution used to represent the likelihood that a person randomly clicking on links will arrive at any particular page</p> </blockquote> <p>Adapting the reasoning to our case, we can think of it as in terms of houses and battle outcomes. By walking through the Markov network following edge direction (which is from loser to winner), we discover the stationary probability distribution of the Markov chain. This represent the probability that, starting from a house at random and moving in the direction of battles outcome, after a while we expect to celebrate the victory of a house for that invariant amount of time.</p> <p>The results show that the house Frey is the most powerful, and the \(11.7%\) of times we expect to come to House Frey having a party for their victory.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>                        Frey                   Lannister
                  0.11706463                  0.10476410
                      Bolton                   Baratheon
                  0.09134930                  0.08013144
               Night's Watch                     Greyjoy
                  0.06422775                  0.04357728
                       Stark          Brotherhood without Banners
                  0.04331037                  0.04023057
                     Bracken                       Tully
                  0.04023057                  0.03713693
                       Darry                    Karstark
                  0.03713693                  0.03440543
                     Mormont                      Glover
                  0.03440543                  0.03440543
            Brave Companions                   Mallister
                  0.02823198                  0.02823198
                   Free folk                      Tyrell
                  0.02823198                  0.02823198
                   Blackwood                      Thenns
                  0.02823198                  0.02823198
                      Giants
                  0.02823198
</code></pre></div></div> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># It has to output 1, being a probability distribution</span><span class="w">
</span><span class="nf">sum</span><span class="p">(</span><span class="n">pr</span><span class="o">$</span><span class="n">vector</span><span class="p">)</span><span class="w">
</span><span class="m">1</span><span class="w">
</span></code></pre></div></div> <h1 id="acknowledgements">Acknowledgements</h1> <ul> <li><a href="https://www.kaggle.com/sergeycherkasov/d/mylesoneill/game-of-thrones/test-test">Some analysis of Game of Throne data</a> - Sergey Cherkasov</li> <li><a href="https://www.kaggle.com/shaildeliwala/d/mylesoneill/game-of-thrones/exploratory-analysis-and-predictions">Exploratory Analysis and Predictions</a> - Shail Deliwala</li> <li><a href="https://www.kaggle.com/gowrishankarin/d/mylesoneill/game-of-thrones/analysis-on-battles">Systematic Analysis on GoT Battles</a> - Gowri Shankar</li> <li><a href="https://www.kaggle.com/colinfraser/d/mylesoneill/game-of-thrones/battles-investigation">Battles investigation</a> - ColinFraser</li> <li><a href="http://motioninsocial.com/tufte/">Tufte in R</a> - Lukasz Piwek</li> </ul>]]></content><author><name>Mirko Mazzoleni</name></author><category term="fun"/><category term="visualization"/><category term="R"/><summary type="html"><![CDATA[Visualization of Game of Thrones battles]]></summary></entry><entry><title type="html">A Games of Tufte - Part I</title><link href="https:/mirkomazzoleni.github.io/blog/2016/game_of_tutfe/" rel="alternate" type="text/html" title="A Games of Tufte - Part I"/><published>2016-08-06T00:00:00+00:00</published><updated>2016-08-06T00:00:00+00:00</updated><id>https:/mirkomazzoleni.github.io/blog/2016/game_of_tutfe</id><content type="html" xml:base="https:/mirkomazzoleni.github.io/blog/2016/game_of_tutfe/"><![CDATA[<p>This report concerns the first part of an exploratory data analysis based on the Games of Thrones dataset hosted on <a href="https://www.kaggle.com/mylesoneill/game-of-thrones">Kaggle</a>. The aim of this work is to familiarize with the data for subsequent analysis, and using the Tufte design rules to represent the plots. During the process, personal domain knowledge (acquired from books and not the tv series) is used to motivate hypothesis and decisions. Since there aren’t motivations or questions that brought me to collect data, in order to answer to them, we let the Exploratory Data Analysis phase to generate questions for us. A sound answer to those questions would require at least another dataset, so we let to fix in mind the fact that we are simply describing the dataset at hand, without the temptation to make inferences or other types of final statements.</p> <p>The entire code for this post can be found <a href="https://github.com/MirkoMazzoleni/MirkoMazzoleni.github.io/blob/master/assets/code/2016-08-05-game_of_tutfe.Rmd">here</a>.</p> <hr/> <h2 id="data-cleaning-and-questions-generation">Data cleaning and questions generation</h2> <p>After having load the required libraries and the dataset, which contains information about the main battles in the reign of Westeros during the <a href="ttp://awoiaf.westeros.org/index.php/War_of_the_Five_Kings">War of the Five Kings</a>, let’s first take an overview of the dataset at hand by checking the variables at our disposal. We can see \(38\) observations for each of the \(25\) variables. The next step will be to gain confidence with the features and the values they can take.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  'data.frame':	38 obs. of  25 variables:
   $ name              : Factor w/ 38 levels "Battle at the Mummer's Ford",..: 13 1 7 14 18 10 25 5 3 17 ...
   $ year              : int  298 298 298 298 298 298 298 299 299 299 ...
   $ battle_number     : int  1 2 3 4 5 6 7 8 9 10 ...
   $ attacker_king     : Factor w/ 5 levels "","Balon/Euron Greyjoy",..: 3 3 3 4 4 4 3 2 2 2 ...
   $ defender_king     : Factor w/ 7 levels "","Balon/Euron Greyjoy",..: 6 6 6 3 3 3 6 6 6 6 ...
   $ attacker_1        : Factor w/ 11 levels "Baratheon","Bolton",..: 10 10 10 11 11 11 10 9 9 9 ...
   $ attacker_2        : Factor w/ 8 levels "","Bolton","Frey",..: 1 1 1 1 8 8 1 1 1 1 ...
   $ attacker_3        : Factor w/ 3 levels "","Giants","Mormont": 1 1 1 1 1 1 1 1 1 1 ...
   $ attacker_4        : Factor w/ 2 levels "","Glover": 1 1 1 1 1 1 1 1 1 1 ...
   $ defender_1        : Factor w/ 13 levels "","Baratheon",..: 12 2 12 8 8 8 6 11 11 11 ...
   $ defender_2        : Factor w/ 3 levels "","Baratheon",..: 1 1 1 1 1 1 1 1 1 1 ...
   $ defender_3        : logi  NA NA NA NA NA NA ...
   $ defender_4        : logi  NA NA NA NA NA NA ...
   $ attacker_outcome  : Factor w/ 3 levels "","loss","win": 3 3 3 2 3 3 3 3 3 3 ...
   $ battle_type       : Factor w/ 5 levels "","ambush","pitched battle",..: 3 2 3 3 2 2 3 3 5 2 ...
   $ major_death       : int  1 1 0 1 1 0 0 0 0 0 ...
   $ major_capture     : int  0 0 1 1 1 0 0 0 0 0 ...
   $ attacker_size     : int  15000 NA 15000 18000 1875 6000 NA NA 1000 264 ...
   $ defender_size     : int  4000 120 10000 20000 6000 12625 NA NA NA NA ...
   $ attacker_commander: Factor w/ 32 levels "","Asha Greyjoy",..: 8 6 9 22 16 18 6 30 2 28 ...
   $ defender_commander: Factor w/ 29 levels "","Amory Lorch",..: 7 4 10 28 12 14 15 1 1 1 ...
   $ summer            : int  1 1 1 1 1 1 1 1 1 1 ...
   $ location          : Factor w/ 28 levels "","Castle Black",..: 8 13 17 9 27 17 4 12 5 23 ...
   $ region            : Factor w/ 7 levels "Beyond the Wall",..: 7 5 5 5 5 5 5 3 3 3 ...
   $ note              : Factor w/ 6 levels "","Greyjoy's troop number based on the Battle of Deepwood Motte, in which Asha had 1000 soldier on 30 longships. That comes out to"| __truncated__,..: 1 1 1 1 1 1 1 1 1 2 ...
</code></pre></div></div> <h3 id="question-expectation-and-answers">Question, Expectation and Answers</h3> <p>In this section, we will follow the following logical framework:</p> <ol> <li>Letting the exploration generate the questions</li> <li>Setting an expectation for what the data will tell us</li> <li>Revise or confirm the expectation in the light of analysed data</li> </ol> <p>Being the dataset composed most by categorical variables, we want to know first the discrete values that these variables can take, and see if any question arises.</p> <h3 id="categorical-data">Categorical Data</h3> <p>This section deals with the understanding and cleaning of categorical variables in the dataset.</p> <h4 id="attacker-king">Attacker King</h4> <p>The variable represents the attacker’s king. A slash indicates that the king changes over the course of the war. The levels of this variable are:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>""  "Balon/Euron Greyjoy"  "Joffrey/Tommen Baratheon"  "Robb Stark"  "Stannis Baratheon"
</code></pre></div></div> <p>The fact, in some circumstances, that there isn’t an attacking king is not an error: simply can be that there is no attacking king commanding the troops. In this case throwing away missing data can be detrimental, as they can be source of information. For example, a value of “ “ can mean “unknown” or “not applicable”, so it should be encoded in that way. Usually I search for trend in missing data to see if they miss for a reason.</p> <blockquote> <p><strong>Question Q1</strong>: Does the “ “ level mean something? <strong>Expectation E1</strong>: Yes, simply there’s no king. <strong>Answer A1</strong>: The “ “ stands for “NoKing”.</p> </blockquote> <ul> <li>Check the battle names where there is no attacker king and possible notes on that battles:</li> </ul> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>                name                 note
23   Battle of the Burning Septry     
30   Sack of Saltpans
</code></pre></div></div> <ul> <li>Is the missing king due to the battle type? ==&gt; NO, usually pitched battles have a king which guides the army, and troops without a king are expected to act as bandits, preferring a razing or ambush strategy:</li> </ul> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
                     FALSE TRUE
                       1    0
    ambush            10    0
    pitched battle    13    1
    razing             1    1
    siege             11    0
</code></pre></div></div> <ul> <li>Is the missing king due to the attacker? ==&gt; YES, the Brave Companions and the Brotherhood don’t have a king:</li> </ul> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
                                  FALSE TRUE
    Baratheon                       6    0
    Bolton                          2    0
    Bracken                         1    0
    Brave Companions                0    1
    Brotherhood without Banners     0    1
    Darry                           1    0
    Free folk                       1    0
    Frey                            2    0
    Greyjoy                         7    0
    Lannister                       8    0
    Stark                           8    0
</code></pre></div></div> <ul> <li>Is the previous conclusion the right one? Let’s Check for other associations. Seems that the Riverlands are land of no-one, and bandits or sellswords prefer to fight in that area!</li> </ul> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
                      FALSE TRUE
    Beyond the Wall     1    0
    The Crownlands      2    0
    The North          10    0
    The Reach           2    0
    The Riverlands     15    2
    The Stormlands      3    0
    The Westerlands     3    0
</code></pre></div></div> <p>The most plausible answer is that the missing value is related to fighters which don’t have a king. We can then fill the missing value with a new one, the “NoKing” value in this case.</p> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">levels</span><span class="p">(</span><span class="n">battles</span><span class="o">$</span><span class="n">attacker_king</span><span class="p">)[</span><span class="n">match</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span><span class="n">levels</span><span class="p">(</span><span class="n">battles</span><span class="o">$</span><span class="n">attacker_king</span><span class="p">))]</span><span class="o">=</span><span class="s2">"NoKing"</span><span class="w">
</span></code></pre></div></div> <blockquote> <p><strong>Question Q2</strong>: Who is the king who attacked more? <strong>Expectation E2</strong>: Joffrey/Tommen Baratheon, being Joffrey the most sadistic character. <strong>Answer A2</strong>: Joffrey/Tommen Baratheon</p> </blockquote> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-9-1.svg-480.webp 480w,/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-9-1.svg-800.webp 800w,/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-9-1.svg-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-9-1.svg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h4 id="defender-king">Defender King</h4> <p>This variable represents the defender’s king. The levels are:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>""  "Balon/Euron Greyjoy"  "Joffrey/Tommen Baratheon"  "Mance Rayder"  "Renly Baratheon"
    "Robb Stark"  "Stannis Baratheon"
</code></pre></div></div> <blockquote> <p><strong>Question Q3</strong>: Does the “ “ level mean something? <strong>Expectation E3</strong>: Yes, simply there’s no king. <strong>Answer A3</strong>: No king.</p> </blockquote> <p>From the data we can see that there are 3 battles without a defending king.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>             name                    note
  23 Battle of the Burning Septry     
  25 Retaking of Harrenhal     
  30 Sack of Saltpans
</code></pre></div></div> <p>Digging a little deeper shows that two of them were against the brave Companion which don’t have a king, and the remaining one is a razing, that is, an attack against an undefended position:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
                         ambush  pitched battle  razing  siege
                     0      0         0             1     0
    Baratheon        0      0         0             0     0
    Blackwood        0      0         0             0     0
    Bolton           0      0         0             0     0
    Brave Companions 0      0         2             0     0
    Darry            0      0         0             0     0
    Greyjoy          0      0         0             0     0
    Lannister        0      0         0             0     0
    Mallister        0      0         0             0     0
    Night's Watch    0      0         0             0     0
    Stark            0      0         0             0     0
    Tully            0      0         0             0     0
    Tyrell           0      0         0             0     0
</code></pre></div></div> <p>I feel confident to label the “ “ value to the “NoKing” one.</p> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">levels</span><span class="p">(</span><span class="n">battles</span><span class="o">$</span><span class="n">defender_king</span><span class="p">)[</span><span class="n">match</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span><span class="n">levels</span><span class="p">(</span><span class="n">battles</span><span class="o">$</span><span class="n">defender_king</span><span class="p">))]</span><span class="o">=</span><span class="s2">"NoKing"</span><span class="w">
</span></code></pre></div></div> <blockquote> <p><strong>Question Q4</strong>: Whose king undergone more attacks? <strong>Expectation E4</strong>: Robb Stark, it seems that everyone wants the North. <strong>Answer A4</strong>: Robb Stark.</p> </blockquote> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-13-1.svg-480.webp 480w,/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-13-1.svg-800.webp 800w,/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-13-1.svg-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-13-1.svg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p><strong>Observation O1</strong>: From the previous plots, it seems that both Renly Baratheon and Mance Rayder did not have the time, or the will, to perform any attack: they only defended their position.</p> <h4 id="attackers">Attackers</h4> <p>These variables indicates the major houses attacking.</p> <p>Main attackers:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  "Baratheon"  "Bolton"  "Bracken"  "Brave Companions"  "Brotherhood without Banners"
  "Darry"  "Free folk"  "Frey"    "Greyjoy"  "Lannister"         "Stark"
</code></pre></div></div> <p>Second attackers:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>""  "Bolton"  "Frey"  "Greyjoy"  "Karstark"  "Lannister"  "Thenns"  "Tully"
</code></pre></div></div> <p>Third attackers:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>""  "Giants"  "Mormont"
</code></pre></div></div> <p>Fourth attackers:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>""  "Glover"
</code></pre></div></div> <p>It can be seen that even in the attackers levels, except for the variable <em>attacker_1</em>, there are missing information represented as an empty string. Intuitively, this represent the fact that there aren’t the same number of allies for every battles. We can encode the missing values as “NonPresent”, indicating that an attacker is not present for that battle.</p> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">levels</span><span class="p">(</span><span class="n">battles</span><span class="o">$</span><span class="n">attacker_2</span><span class="p">)[</span><span class="n">match</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span><span class="n">levels</span><span class="p">(</span><span class="n">battles</span><span class="o">$</span><span class="n">attacker_2</span><span class="p">))]</span><span class="o">=</span><span class="s2">"NotPresent"</span><span class="w">
</span><span class="n">levels</span><span class="p">(</span><span class="n">battles</span><span class="o">$</span><span class="n">attacker_3</span><span class="p">)[</span><span class="n">match</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span><span class="n">levels</span><span class="p">(</span><span class="n">battles</span><span class="o">$</span><span class="n">attacker_3</span><span class="p">))]</span><span class="o">=</span><span class="s2">"NotPresent"</span><span class="w">
</span><span class="n">levels</span><span class="p">(</span><span class="n">battles</span><span class="o">$</span><span class="n">attacker_4</span><span class="p">)[</span><span class="n">match</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span><span class="n">levels</span><span class="p">(</span><span class="n">battles</span><span class="o">$</span><span class="n">attacker_4</span><span class="p">))]</span><span class="o">=</span><span class="s2">"NotPresent"</span><span class="w">
</span></code></pre></div></div> <p>Another observation is that the House Glover is present all the times that 4 attackers participated in a battle.</p> <blockquote> <p><strong>Question Q5</strong>: What are the battle with the maximum number of attackers? <strong>Expectation E5</strong>: Probably the battles to conquer the North. <strong>Answer A5</strong>: The battles were those carried on by Stannis Baratheon to free the North from the Greyjoy’s and Winterfell from Bolton’s:</p> </blockquote> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>            name                     attacker_king         defender_king       attacker_outcome   region
31  Retaking of Deepwood Motte   Stannis Baratheon    Balon/Euron Greyjoy           win        The North
38  Siege of Winterfell          Stannis Baratheon    Joffrey/Tommen Baratheon                 The North    
</code></pre></div></div> <p><strong>Observation O2</strong>:This last battle does not have an outcome, because in the book we only know a letter send to Jon Snow by Ramsey Bolton which tells him that Stannis died, but we are not sure of the letter trustfulness.</p> <blockquote> <p><strong>Question Q6</strong>: There are other cases with missing <em>attacker_outcome</em>? <strong>Expectation E6</strong>: Probably not, since that is the last battle of the books until now. <strong>Answer A6</strong>: No, that battle is the only one. We can set the missing value to “unknown”:</p> </blockquote> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>            name             attacker_king         defender_king          region
38  Siege of Winterfell   Stannis Baratheon   Joffrey/Tommen Baratheon   The North
</code></pre></div></div> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">levels</span><span class="p">(</span><span class="n">battles</span><span class="o">$</span><span class="n">attacker_outcome</span><span class="p">)[</span><span class="n">match</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span><span class="n">levels</span><span class="p">(</span><span class="n">battles</span><span class="o">$</span><span class="n">attacker_outcome</span><span class="p">))]</span><span class="o">=</span><span class="s2">"unknown"</span><span class="w">
</span></code></pre></div></div> <h4 id="defenders">Defenders</h4> <p>This variable indicates the major houses defending.</p> <p>Main defenders:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>""   "Baratheon"  "Blackwood"  "Bolton"  "Brave Companions" "Darry"  "Greyjoy"          
     "Lannister"  "Mallister"  "Night's Watch"  "Stark"  "Tully"  "Tyrell"
</code></pre></div></div> <p>Second defenders:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>""  "Baratheon"  "Frey"
</code></pre></div></div> <p>Third defenders:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  NULL
</code></pre></div></div> <p>Fourth defenders:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  NULL
</code></pre></div></div> <p>It can be seen that even in the defenders levels there are missing information represented as an empty string. As with the attackers, we can encode the missing values as “NonPresent”, indicating that a defender is not present for that battle.</p> <p><strong>Observation O3</strong>: It can be further noticed that nobody defended with more than one ally, and the <em>defender_3</em> and <em>defender_4</em> columns can be removed from the dataset.</p> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">levels</span><span class="p">(</span><span class="n">battles</span><span class="o">$</span><span class="n">defender_2</span><span class="p">)[</span><span class="n">match</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span><span class="n">levels</span><span class="p">(</span><span class="n">battles</span><span class="o">$</span><span class="n">defender_2</span><span class="p">))]</span><span class="o">=</span><span class="s2">"NotPresent"</span><span class="w">
</span><span class="n">battles</span><span class="o">$</span><span class="n">defender_3</span><span class="o">=</span><span class="kc">NULL</span><span class="w">
</span><span class="n">battles</span><span class="o">$</span><span class="n">defender_4</span><span class="o">=</span><span class="kc">NULL</span><span class="w">
</span></code></pre></div></div> <blockquote> <p><strong>Question Q7</strong>: What does it mean a “ “ value on the variable <em>defender_1</em>? <strong>Expectation E7</strong>: A battle was fought without defenders, and probably was a razing. <strong>Answer A7</strong>: The battle was indeed a razing and there were nor attackers neither defender kings. We can set the missing value to the “NotPresent” one:</p> </blockquote> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>           name         attacker_king     attacker_1     defender_king   battle_type
 30  Sack of Saltpans      NoKing      Brave Companions     NoKing          razing
</code></pre></div></div> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">levels</span><span class="p">(</span><span class="n">battles</span><span class="o">$</span><span class="n">defender_1</span><span class="p">)[</span><span class="n">match</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span><span class="n">levels</span><span class="p">(</span><span class="n">battles</span><span class="o">$</span><span class="n">defender_1</span><span class="p">))]</span><span class="o">=</span><span class="s2">"NotPresent"</span><span class="w">
</span></code></pre></div></div> <h4 id="attacker-outcomes">Attacker outcomes</h4> <p>This variable indicates the outcome from the perspective of the attacker. Categories: win, loss, draw.</p> <blockquote> <p><strong>Question Q8</strong>: What are the possible outcomes? <strong>Expectation E8</strong>: From the codebook, the possible values are “draw”, “win”, “loss”.<strong>Answer A8</strong>: The values are under the expectations but no battle ended with a “draw”:</p> </blockquote> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"unknown"  "loss"  "win"
</code></pre></div></div> <h4 id="battle-types">Battle types</h4> <p>A classification of the battle’s primary type. Categories:</p> <ul> <li>Pitched_battle: armies meet in a location and fight.</li> <li>Ambush: a battle where stealth or subterfuge was the primary means of attack.</li> <li>Siege: a prolonged of a forties position.</li> <li>Razing: an attack against an undefended position</li> </ul> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>""  "ambush"  "pitched battle"  "razing"  "siege"
</code></pre></div></div> <blockquote> <p><strong>Question Q9</strong>: What does it mean the value “ “ on the variable <em>battle_type</em>? <strong>Expectation E9</strong>: Probably an unknown battle type. <strong>Answer A9</strong>: The value is not indicated because is unknown how the battle went and its outcome, being the battle the Siege of Winterfell by Stannis Baratheon:</p> </blockquote> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>               name         attacker_king    attacker_outcome    defender_king         battle_type
38  Siege of Winterfell   Stannis Baratheon     unknown       Joffrey/Tommen Baratheon  
</code></pre></div></div> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">levels</span><span class="p">(</span><span class="n">battles</span><span class="o">$</span><span class="n">battle_type</span><span class="p">)[</span><span class="n">match</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span><span class="n">levels</span><span class="p">(</span><span class="n">battles</span><span class="o">$</span><span class="n">battle_type</span><span class="p">))]</span><span class="o">=</span><span class="s2">"unknown"</span><span class="w">
</span></code></pre></div></div> <h4 id="attacker-commander">Attacker commander</h4> <p>Major commanders of the attackers. Commander’s names are included without honorific titles and commanders are separated by commas. Since there are many commanders, only the first are reported:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>""  "Asha Greyjoy"  "Dagmer Cleftjaw"   "Daven Lannister, Ryman Fey, Jaime Lannister"
    "Euron Greyjoy, Victarion Greyjoy"  "Gregor Clegane"
</code></pre></div></div> <blockquote> <p><strong>Question Q10</strong>: What does it mean the value “ “ on the variable <em>attacker_commander</em>? <strong>Expectation E10</strong>: Probably a missing or unknown commander. <strong>Answer A10</strong>: The value is not indicated because there wasn’t a commander, being a battle led by the Brotherhood without Banners. We can set the missing value to a “NotPresent” one:</p> </blockquote> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>              name                attacker_king        attacker_1             defender_king    battle_type
23 Battle of the Burning Septry      NoKing      Brotherhood without Banners     NoKing      pitched battle
</code></pre></div></div> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">levels</span><span class="p">(</span><span class="n">battles</span><span class="o">$</span><span class="n">attacker_commander</span><span class="p">)[</span><span class="n">match</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span><span class="n">levels</span><span class="p">(</span><span class="n">battles</span><span class="o">$</span><span class="n">attacker_commander</span><span class="p">))]</span><span class="o">=</span><span class="s2">"NotPresent"</span><span class="w">
</span></code></pre></div></div> <h4 id="defender-commander">Defender commander</h4> <p>Major commanders of the defenders. Commander’s names are included without honoric titles and commanders are separated by commas. Since there are many commanders, only the first one are reported:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>""  "Amory Lorch"  "Asha Greyjoy"  "Beric Dondarrion"  "Bran Stark"  "Brynden Tully"
</code></pre></div></div> <blockquote> <p><strong>Question Q11</strong>: What does it mean the value “ “ on the variable <em>defender_commander</em>? <strong>Expectation E11</strong>: Probably a missing or unknown commander. <strong>Answer A11</strong>: The value is not indicated because there wasn’t a commander, or it was unknown. In the battles where there is “NoKing” as <em>defender_king</em>, we can assume that the a <em>defender_commander</em> was not present. In the rest of the battles, which most of them are led by the Greyjoy’s, probably there was a <em>defender_commander</em> but is not indicated, and thus is unknown:</p> </blockquote> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>            name                    attacker_king            defender_king           battle_type
8   Battle of Moat Cailin          Balon/Euron Greyjoy        Robb Stark pitched         battle
9   Battle of Deepwood Motte       Balon/Euron Greyjoy        Robb Stark                 siege
10  Battle of the Stony Shore      Balon/Euron Greyjoy        Robb Stark                 ambush
13  Sack of Torrhen's Square       Balon/Euron Greyjoy        Balon/Euron Greyjoy        siege
21  Siege of Darry                  Robb Stark                Joffrey/Tommen Baratheon   siege
23  Battle of the Burning Septry   NoKing                     NoKing pitched             battle
29  Fall of Moat Cailin            Joffrey/Tommen Baratheon   Balon/Euron Greyjoy        siege
30  Sack of Saltpans               NoKing                     NoKing                     razing
32  Battle of the Shield Islands   Balon/Euron Greyjoy        Joffrey/Tommen Baratheon   pitched battle
33  Invasion of Ryamsport,         Balon/Euron Greyjoy        Joffrey/Tommen Baratheon   razing
    Vinetown, and Starfish Harbor
</code></pre></div></div> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">levels</span><span class="p">(</span><span class="n">battles</span><span class="o">$</span><span class="n">defender_commander</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">levels</span><span class="p">(</span><span class="n">battles</span><span class="o">$</span><span class="n">defender_commander</span><span class="p">),</span><span class="w"> </span><span class="s2">"NotPresent"</span><span class="p">,</span><span class="s2">"unknown"</span><span class="p">)</span><span class="w">
</span><span class="n">battles</span><span class="p">[</span><span class="n">battles</span><span class="o">$</span><span class="n">defender_king</span><span class="o">==</span><span class="s2">"NoKing"</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">battles</span><span class="o">$</span><span class="n">defender_commander</span><span class="o">==</span><span class="s2">""</span><span class="p">,</span><span class="s2">"defender_commander"</span><span class="p">]</span><span class="o">=</span><span class="s2">"NotPresent"</span><span class="w">
</span><span class="n">battles</span><span class="p">[</span><span class="n">battles</span><span class="o">$</span><span class="n">defender_commander</span><span class="o">==</span><span class="s2">""</span><span class="p">,</span><span class="s2">"defender_commander"</span><span class="p">]</span><span class="o">=</span><span class="s2">"unknown"</span><span class="w">
</span><span class="n">battles</span><span class="o">$</span><span class="n">defender_commander</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">droplevels</span><span class="p">(</span><span class="n">battles</span><span class="o">$</span><span class="n">defender_commander</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <h4 id="battles-locations">Battles locations</h4> <p>This variable represents the battle location. Levels are:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>""  "Castle Black"  "Crag"   "Darry"  "Deepwood Motte"  "Dragonstone"
</code></pre></div></div> <blockquote> <p><strong>Question Q12</strong>: What does it mean the value “ “ on the variable <em>location</em>? <strong>Expectation E12</strong>: Probably a missing or unknown location <strong>Answer A12</strong>: The location <a href="http://awoiaf.westeros.org/index.php/Battle_at_the_burning_septry">is not known</a>:</p> </blockquote> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>             name                 attacker_king   defender_king
23 Battle of the Burning Septry       NoKing          NoKing
</code></pre></div></div> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">levels</span><span class="p">(</span><span class="n">battles</span><span class="o">$</span><span class="n">location</span><span class="p">)[</span><span class="n">match</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span><span class="n">levels</span><span class="p">(</span><span class="n">battles</span><span class="o">$</span><span class="n">location</span><span class="p">))]</span><span class="o">=</span><span class="s2">"unknown"</span><span class="w">
</span></code></pre></div></div> <h4 id="battle-regions">Battle regions</h4> <p>The region where the battle takes place. Categories: Beyond the Wall, The North, The Iron Islands, The Riverlands, The Vale of Arryn, The Westerlands, The Crownlands, The Reach, The Stormlands, Dorne</p> <blockquote> <p><strong>Question Q13</strong>: What are the values assume med by the variable? <strong>Expectation E13</strong>: The values assumed by the variable are those described in the codebook. <strong>Answer A13</strong>: The answer meets the expectation, except for the regions “The Iron Islands”, “The Vale of Arryn” and “Dorne”, probably because no battle were fought in those regions:</p> </blockquote> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"Beyond the Wall"  "The Crownlands"  "The North"  "The Reach"  "The Riverlands"  
"The Stormlands"   "The Westerlands"
</code></pre></div></div> <h3 id="numerical-data">Numerical Data</h3> <p>This section deals with the understanding and cleaning of numerical variables in the dataset.</p> <h4 id="year">Year</h4> <p>The year of the battle. We convert it to a factor variable for convenience and representation, since it assumes only \(3\) different values.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   Min.  1st Qu.  Median   Mean    3rd Qu.  Max.
  298.0   299.0    299.0   299.1   300.0   300.0
</code></pre></div></div> <h4 id="attacker-size">Attacker size</h4> <p>The size of the attacker’s force. No distinction is made between the types of soldiers such as cavalry and footmen:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   Min.  1st Qu.  Median  Mean   3rd Qu.   Max.   NA's
    20    1375     4000   9943    8250   100000    14
</code></pre></div></div> <p>From the summary we can see that the distribution of the attacker army has a mean of about \(10000\) soldiers , but is very scattered with many missing numbers. Particularly impressing is maximum number of \(100000\) men.</p> <blockquote> <p><strong>Question Q14</strong>: Which is the battle with \(100000\) men? <strong>Expectation E14</strong>: A battle in the North with the wildlings. <strong>Answer A14</strong>: The battle was the assault of Castle Black by the wildlings and free folk, when Jon Snow loses Igritte. We can see that there is an error in the data, because we know that Stannis Baratheon was on the Night’s side, defending the Nigth’s Watch and seizing Mance Rayder. Furthermore, Stannis won the battle and Mance Rayder lost it, thus the <em>attacker_king</em> and <em>defender_king</em> variables should be swapped. The number of \(100000\) is more meaningful now if we think of it as the army of all the freefolks, as it is also reported <a href="http://awoiaf.westeros.org/index.php/Battle_of_Castle_Black">here</a>:</p> </blockquote> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>           name               attacker_king     defender_king   attacker_1    defender_1    attacker_outcome
28 Battle of Castle Black   Stannis Baratheon    Mance Rayder    Free folk   Night's Watch       loss
</code></pre></div></div> <blockquote> <p><strong>Question Q15</strong>: When attacking, which battle type required more men? <strong>Expectation E15</strong>: Probably the <em>pitched battle</em> type, since it requires more men than ambush or a siege, which require more discretion and tools (trebuchets, rams) capability respectively. <strong>Answer 15</strong>: The <em>pitched battle</em> has the higher median (about \(10000\) troops) and it is very skewed around this value, and only \(25%\) of values are lower than \(3000\) troops. Perhaps surprising, the median of the <em>ambush</em> distribution is similar to that of <em>siege</em>, being the latter more concentrated, indicating that there some standard number of troops to do a siege. Here we have isolated cases of ambushes with less than \(30\) men, and a siege with \(100000\) men (the Mance Rayder attack to Castle Black). We Do not consider “unknown” o “razing” battles since they have few or none observations.</p> </blockquote> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-35-1.svg-480.webp 480w,/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-35-1.svg-800.webp 800w,/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-35-1.svg-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-35-1.svg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <blockquote> <p><strong>Question Q16</strong>: When attacking, which king had the most numerous army? <strong>Expectation E16</strong>: We already know that Mance Rayder commanded \(100000\) men. <strong>Answer 16</strong>: Mance had the most numerous attacking army, but he attacked only one time, so it is more interesting to considered the other kings. I made the choice to exclude from the comparison also the “NoKing” category, since it has few observations. We can see from the plot that the Greyjoy’s had the smallest army, ranging from \(10\) to \(1000\) men. The Lannister’s and the Stark’s show a high median value army, but that also had great variation in its forces, mainly for Robb Stark. This can be probably due to his attitude to perform ambush attacks with few men. Stannis Baratheon forces undergo few losses, having a quite concentrated distribution.</p> </blockquote> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-36-1.svg-480.webp 480w,/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-36-1.svg-800.webp 800w,/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-36-1.svg-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-36-1.svg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h4 id="defender-size">Defender size</h4> <p>The size of the defender’s force. No distinction is made between the types of soldiers such as cavalry and footmen.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   Min.  1st Qu.  Median  Mean   3rd Qu.  Max.   NA's
   100    1070    6000    6428   10000   20000     19
</code></pre></div></div> <blockquote> <p><strong>Question Q17</strong>: When attacking, which king had the most numerous army? <strong>Expectation E17</strong>:Probably the Lannister’s or Stannis Baratheon. <strong>Answer 17</strong>: Apart from the “Noking” and “Renly Baratheon”, which have few observation, the plots show that the Lannister’s defended their position with more troops than the other, and Stannis Baratheon, despite attacking with an high number of troops, defended with very few ones.</p> </blockquote> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-38-1.svg-480.webp 480w,/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-38-1.svg-800.webp 800w,/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-38-1.svg-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/posts/2016-08-06-games_of_tufte/unnamed-chunk-38-1.svg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h1 id="acknowledgements">Acknowledgements</h1> <ul> <li><a href="https://www.kaggle.com/sergeycherkasov/d/mylesoneill/game-of-thrones/test-test">Some analysis of Game of Throne data</a> - Sergey Cherkasov</li> <li><a href="https://www.kaggle.com/shaildeliwala/d/mylesoneill/game-of-thrones/exploratory-analysis-and-predictions">Exploratory Analysis and Predictions</a> - Shail Deliwala</li> <li><a href="https://www.kaggle.com/gowrishankarin/d/mylesoneill/game-of-thrones/analysis-on-battles">Systematic Analysis on GoT Battles</a> - Gowri Shankar</li> <li><a href="http://motioninsocial.com/tufte/">Tufte in R</a> - Lukasz Piwek</li> </ul>]]></content><author><name>Mirko Mazzoleni</name></author><category term="fun"/><category term="visualization"/><category term="R"/><summary type="html"><![CDATA[Visualization of Game of Thrones battles]]></summary></entry></feed>